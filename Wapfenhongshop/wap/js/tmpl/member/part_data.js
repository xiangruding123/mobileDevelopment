!function(e){function t(e){FL.ajaxDate("get",sms_code_init,{mobile:e},function(e){if("0"===e.error){var t=e.result;if(countdown=t.countdown,if_captcha=t.if_captcha,mobile_correct=t.mobile_correct,sms_available=t.sms_available,$("#getCode").attr("countdown",countdown),t.last_countdown&&FL.countDown(t.last_countdown,$("#getCode")),"1"==if_captcha){$("#secodebox").show();var o=$("#mobile").val();$("#img_secode").attr("src",WapSiteUrl+"/api/index.php?act=common_index&op=get_captcha&flag=wap&mobile="+o),i()}else{$("#secodebox").hide();var s=$("#getCode").attr("countdown");$("#code").focus();var o=$("#mobile").val();FL.getSmsCode(o,s,"getCode"),a()}$(".agree").click(function(){if($(this).hasClass("yes"))$(this).prop("src","../../images/wap/login/noagree.png"),$(this).removeClass("yes"),$("#nextStep").attr("disabled","disabled");else{$(this).prop("src","../../images/wap/login/agree.png"),$(this).addClass("yes");var e=$("#password").val().length;e>5&&e<21&&$("#code").val().length>3&&$("#nextStep").removeAttr("disabled")}}),$(".cleareye").click(function(){"text"==$("#password").attr("type")?($("#password").prop("type","password"),$(".cleareye").prop("src","../../src/images/wap/login/eye.png")):($("#password").prop("type","text"),$(".cleareye").prop("src","../../src/images/wap/login/eyeclick.png"))}),$(".cleartext").click(function(){$(this).parent("div").find("input").val("").focus(),$(this).hide()})}})}function o(e){$.ajax({type:"get",url:if_account_exists,data:{account:e,flag:"wap"},dataType:"json",success:function(o){o&&"0"===o.error&&("1"==o.result?layer.msg("该账号已注册"):"0"==o.result?/^[1][34578]\d{9}$/.test(e)&&2==localStorage.getItem("onetime")&&(localStorage.setItem("onetime","1"),t(e),$("#getCode").hasClass("nogetcode")&&($("#secodebox").show(),$("#img_secode").attr("src",WapSiteUrl+"/api/index.php?act=common_index&op=get_captcha&flag=wap&mobile="+e),i())):layer.msg("请输入正确的手机号！"))}})}function a(){$("#getCode").click(function(){var e=$("#mobile").val();if($("#getCode").hasClass("nogetcode"))$("#secodebox").show(),$("#img_secode").attr("src",WapSiteUrl+"/api/index.php?act=common_index&op=get_captcha&flag=wap&mobile="+e),i();else{var t=$("#getCode").attr("countdown");$("#code").focus(),FL.getSmsCode(e,t,"getCode")}}),$("#code").keyup(function(){var e=this,t=$(e).val().length;t>1?$(".cleartext").show():$(".cleartext").hide();var o=$("#password").val().length;o>5&&o<21&&t>3&&$(".agree").hasClass("yes")?$("#nextStep").removeAttr("disabled"):$("#nextStep").attr("disabled","disabled")}),$("#password").keyup(function(){var e=this,t=$(e).val().length;t>5&&t<21&&$("#code").val().length>3&&$(".agree").hasClass("yes")?$("#nextStep").removeAttr("disabled"):$("#nextStep").attr("disabled","disabled")}),s(),$("#nextStep").click(function(){r()})}function i(){$("#getCode").click(function(){var e=$("#mobile").val();if(4!=$("#secode").val().length)layer.msg("请输入正确的图形验证码");else{var t=$("#getCode").attr("countdown");$("#code").focus(),FL.getSmsCode(e,t,"getCode",$("#secode").val())}}),$("#secode,#code").keyup(function(){var e=this,t=$(e).val().length,o=$(e).parent("div").find(".cleartext");t>1?o.show():o.hide();var a=$("#password").val().length;a>5&&a<21&&$("#code").val().length>3&&$(".agree").hasClass("yes")?$("#nextStep").removeAttr("disabled"):$("#nextStep").attr("disabled","disabled")}),$("#nextStep").click(function(){$("#registerForm").valid()&&r()}),$("#password").keyup(function(){var e=this;$(e).val().length>5&&$(e).val().length<21&&$("#code").val().length>3&&$(".agree").hasClass("yes")?$("#nextStep").removeAttr("disabled"):$("#nextStep").attr("disabled","disabled")}),s()}function s(){$("#registerForm").validate({rules:{code:"required",password:{required:!0,minlength:6,maxlength:20}},messages:{code:"手机验证码必填",password:{required:"登录密码必填",minlength:"密码长度不得小于6个字符",maxlength:"密码长度不得大于20个字符"}},errorPlacement:function(e,t){var o=e.text(),a='<div class="tooltip-top" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-in">'+o+"</div></div>";$(".tooltip-top").remove(),t.before(a)}})}function r(){var e=$("input[name='code']").val(),t=$("#mobile").val();FL.ajaxDate("post",check_phone_code,{num:t,code:e},function(e){"0"===e.error?n():layer.msg(e.msg)})}function n(){var e=$("#mobile").val(),t=$("input[name='code']").val(),o=hex_md5($("input[name='password']").val());FL.ajaxDate("post",member_register,{mobile:e,code:t,password:o,deduct_userid:deduct_userid},function(e){"0"===e.error&&(layer.msg("注册成功"),addcookie("member_name",e.result.member_name),addcookie("mid",e.result.member_id,365),addcookie("token",e.result.token,365),addcookie("member_mobile",e.result.member_mobile),addcookie("nickname",e.result.member_nickname),addcookie("store_id",e.result.store_id,365),addcookie("if_shoper",e.result.if_shoper,365),token=e.result.token,member_id=e.result.member_id,setTimeout(function(){location.href="../weidian/shoper.html?mid="+member_id+"&token="+token},2500))})}localStorage.setItem("onetime","2"),deduct_userid=GetQueryString("mid"),$("#secodebox").hide(),$("#getCode").click(function(){var e=$("input[name='mobile']").val();o(e)}),$("#agreement").click(function(){$(".iframehead").show(),$("iframe").show()}),$(".iframehead .goback").click(function(){$(".iframehead").hide(),$("iframe").hide()});var d=function(){this.onLoad=function(){}};e.Member=e.Member||{},Member.WxBind=new d}(this);