!function(e){function t(){l("yes",u,g,w,y)}function n(e){window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){e(WebViewJavascriptBridge)},!1)}function o(){var e={func:"getmember",params:""};k.send(e,function(e){null==e?a():(y=e.member_id,token=e.token,storeId=e.store_id),t()})}function a(){var e={func:"gotoLogin4Result",params:""};k.send(e,function(e){o()})}function s(e,t,o,a){var s=navigator.userAgent.toLowerCase();s.indexOf("fhmall_android")>0?i(e,t,o,a):s.indexOf("fhmall_ios")>0&&n(function(n){k=n;try{n.init(function(e,t){})}catch(s){}r(e,t,o,a)})}function i(e,t,n,o){var a={title:e,content:t,imgs:n,url:o};FHMall.enableShareButton(JSON.stringify(a))}function r(e,t,n,o){var a={func:"enableshare",params:{title:e,content:t,imgs:n,url:o}};k.send(a)}function l(e,t,n,o,a){$.ajax({url:WapSiteUrl+"/api/index.php?act=store_manselect&op=get_manselect_activity",type:"get",dataType:"json",data:{num:t,curpage:n,flag:"wap",store_id:o,mid:a},success:function(t){if(t&&"0"===t.error){$("#rule_name").text("以下商品"+t.result.rule_name);var n=t.result.manselect_rules,o=t.result.goods_nums;d(n,o),sessionStorage.setItem("goods_nums",o),sessionStorage.setItem("objmanselect",JSON.stringify(n));var s=template.render("brandDetails",t);"yes"==e?$("#brand_details").html(s):$("#brand_details").append(s);var i=parseInt($(".brand_details_list li").width());$(".brand_details_list a>img").css({width:i+"px",height:i+"px"}),$("#brand_details img").lazyload({threshold:200}),$(".add-cart").click(function(){var e=$(this).attr("goods_id"),t=1,n=$(this).attr("goods_source"),o={token:token,goods_id:e,quantity:t,store_id:storeId,mid:a,flag:"wap",gc_area:n};c(o)})}}})}function c(e){$("#goods-details #addOne").hide(),$.ajax({url:WapSiteUrl+"/api/index.php?act=buyer_cart&op=add",type:"get",dataType:"json",data:e,success:function(e){if("0"===e.error){layer.msg("添加购物车成功");var t=sessionStorage.getItem("goods_nums"),n=JSON.parse(sessionStorage.getItem("objmanselect"));t=parseFloat(t)+1,d(n,t),sessionStorage.setItem("goods_nums",t)}else if("0008"===e.error)"0"==native_flag?FHMall.gotoLogin4Result(function(e){getMemberInfo();y=obj.member_id,token=obj.token,storeId=obj.store_id}):"1"==native_flag?a():FL.logLogin();else{var o=e.msg||"系统繁忙中,请稍后添加";layer.msg(o)}},error:function(e){}})}function d(e,t){for(var n=0;n<e.length;n++){if(e[n].manselect_nums-t>0){if(n>0){$("#goods_nums").text("已满足【"+e[n-1].manselect_money+"元任选"+e[n-1].manselect_nums+"件】");break}$("#goods_nums").text("已选"+t+"件 再购"+(e[n].manselect_nums-t)+"件立享【"+e[n].manselect_money+"元任选"+e[n].manselect_nums+"件】");break}if(e[n].manselect_nums-t==0){$("#goods_nums").text("已满足【"+e[n].manselect_money+"元任选"+e[n].manselect_nums+"件】");break}e[n].manselect_nums-t<0&&$("#goods_nums").text("已满足【"+e[n].manselect_money+"元任选"+e[n].manselect_nums+"件】")}}function m(){$(window).scroll(function(){var e=document.body.scrollHeight||document.documentElement.scrollHeight,t=document.body.clientHeight||document.documentElement.clientHeight,n=document.body.scrollTop||document.documentElement.scrollTop;if(n+t==e){var o=$(".brand_details_list li").length;page=o/u+1,f!=page&&_.test(page)&&(l("no",u,page,w,y),f=page)}})}var u=10,g=1,f=0,_=/^[-]{0,1}[0-9]{1,}$/;ImgFormat();var p="你最爱的N元任选来啦",h="我在分红全球购发现了一个超值N元任选活动！N元任选N件买买买，想省多少你说的算！会花会省才是王道！",b=location.href,v="http://www.fenhongshop.com/wap/images/wap/logo.png",y="",w=GetQueryString("store_id");if("0"==native_flag)setTimeout(function(){try{var e=getMemberInfo()}catch(n){var e=null}e?(y=e.member_id,token=e.token,storeId=e.store_id):FHMall.gotoLogin4Result(function(t){getMemberInfo();y=e.member_id,token=e.token,storeId=e.store_id}),t()},50);else if("1"==native_flag){var k;n(function(e){k=e;try{e.init(function(e,t){})}catch(t){}o()})}else $(".fh-header").removeClass("none"),y=FL.mid,token=FL.token,storeId=FL.store_id,$("#-mob-share").attr("src","http://f1.webshare.mob.com/code/mob-share.js?appkey=13a3931a47072"),t();$(".share").click(function(){$(".-mob-share-ui").show(),FL.wxShare(p,h,b,v)}),FL.wxShare(p,h,b,v),s(p,h,v,b),m()}(this);