!function(e){function t(){$("#modifyForm").validate({rules:{nickname:{required:!0,minlength:4}},messages:{nickname:{required:"请输入昵称！",minlength:"请输入4-20个字的昵称"}},errorPlacement:function(e,t){var i=e.text(),n='<div class="tooltip-top" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-in">'+i+"</div></div>";$(".tooltip-top").remove(),t.before(n)}})}function i(){$("#saveName").click(function(){if("2"==a)location.replace("person_data.html");else if($("#modifyForm").valid()){var e=$("#nickname").val();/^[a-zA-Z0-9_\-+\u4e00-\u9fa5]+$/.test(e)?n(e):layer.msg("请输入由中英文、数字、“_”、“-”组成的字符")}})}function n(e){$.ajax({type:"post",url:WapSiteUrl+"/api/index.php?act=common_member&op=edit_member_info",data:{nickname:e,mid:FL.mid,token:FL.token,flag:"wap"},dataType:"json",success:function(t){"0"===t.error&&(layer.msg("保存成功"),addcookie("nickname",e),setTimeout(function(){location.replace("person_data.html")},1e3))},error:function(e){}})}var a=GetQueryString("nickname_status"),o=GetQueryString("surplus_time"),r=GetQueryString("member_nickname");r&&$("#nickname").attr("placeholder",r),"1"==a?$("#tip").text("修改昵称后，180天内将不能再次修改"):"2"==a&&($("#tip").text(o+"天可后修改昵称"),$("#nickname").attr("readonly","readonly"));var m=function(){this.onLoad=function(){t(),i()}};e.Member=e.Member||{},Member.ModifyName=new m}(this);