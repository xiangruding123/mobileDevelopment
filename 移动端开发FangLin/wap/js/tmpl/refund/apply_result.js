!function(e){function t(e,t){$.ajax({type:"post",url:WapSiteUrl+"/api/index.php?act=buyer_order&op=get_refund_state",data:{flag:"wap",mid:FL.mid,token:FL.token,state_id:e,refund_id:t},dataType:"json",success:function(a){if(a&&a.result)if(1==e){var i=Math.floor(a.result.countdown/86400),u=Math.floor(a.result.countdown%86400/3600),p=Math.floor(a.result.countdown%86400%3600/60),l=template.render("applyS1",a);$("#apply_s1").html(l),$("#days").text(i),$("#hours").text(u),$("#minutes").text(p)}else 2==e?$("#reason").text(a.result.seller_message):3==e?($("#seller_message").text(a.result.seller_message),n(),r(t),$("#sendGoods").click(function(){s()})):4==e?(n(),r(t),$("#modify").click(function(){s()}),$("#getLogistics").click(function(){location.href="../logistics/logistics.html?order_id="+d})):7==e&&o(t)}})}function r(e){$.ajax({type:"post",url:WapSiteUrl+"/api/index.php?act=buyer_order&op=get_refund_address",data:{flag:"wap",mid:FL.mid,token:FL.token,refund_id:e},dataType:"json",success:function(e){e&&e.result&&($("#consignee").text(e.result.consignee||""),$("#tel").text(e.result.tel||""),$("#address").text(e.result.address||""))}})}function n(){$.ajax({type:"get",url:WapSiteUrl+"/api/index.php?act=common_index&op=get_express",data:{flag:"wap"},dataType:"json",success:function(e){if(e&&e.result){var t=template.render("expressMsg",e);$("#express_msg").html(t)}}})}function s(){var e=$("#express_msg option:checked").val(),t=$("#invoice_no").val();""==t?layer.msg("请输入快递单号"):$.ajax({type:"post",url:WapSiteUrl+"/api/index.php?act=buyer_order&op=refund_ship",data:{flag:"wap",mid:FL.mid,token:FL.token,refund_id:i,express_id:e,invoice_no:t},dataType:"json",success:function(e){e&&0==e.error&&(layer.msg("提交成功"),setTimeout(function(){location.href="refund_progress.html?refund_id="+i},1e3))}})}function o(e){$.ajax({type:"post",url:WapSiteUrl+"/api/index.php?act=buyer_order&op=get_refund_detail",data:{flag:"wap",mid:FL.mid,token:FL.token,refund_id:e},dataType:"json",success:function(e){template.helper("format",FL.dateFormat);var t=template.render("refund",e);$(".row").append(t)}})}var a=GetQueryString("state_id"),i=GetQueryString("refund_id"),d=(GetQueryString("refund_type"),GetQueryString("order_id")),u=function(){this.onLoad=function(){t(a,i)}};e.Goods=e.Goods||{},Goods.refundResult=new u}(this);