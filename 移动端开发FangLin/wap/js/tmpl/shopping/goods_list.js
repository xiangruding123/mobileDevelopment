!function(o){function e(o,e,s,n,t,i,c){$.ajax({url:WapSiteUrl+"/api/index.php?act=common_goods&op=get_goods_list",type:"get",dataType:"json",data:{num:a,curpage:n,flag:"wap",order:e,sort:s,key:t,gc_id:i,gc_deep:2,is_own:c},success:function(e){if(e&&"0"===e.error){$("#emptysearch").hide();var s=template.render("goods_list_tpl",e);"yes"==o&&$(".fh-goods").remove(),$(".pullUp").before(s),$("#goods_list img").lazyload()}else"yes"==o&&($(".fh-goods").remove(),$("#emptysearch").show())}})}function s(){$(".nav li").click(function(){var o=this,s=$(o).attr("num");2==s?($(".nav li").find("a").removeClass("focus-font"),$(o).find("a").attr("class","focus-font"),$(o).find("i").hasClass("icon-sort-up")?n(o,"desc"):n(o,"asc")):($(".nav li").find("a").removeClass("focus-font"),$(o).find("a").attr("class","focus-font"),r=1,d=s,e("yes",2,s,1,i,c))}),$("#goods_search").bind("keydown",function(o){13==o.keyCode&&$(".icon-search").click()}),$(".icon-search").click(function(o){i=$.trim($("#goods_search").val());var s=1;c="",e("yes",r,r,s,i,c,is_own),s++,$.ajax({url:WapSiteUrl+"/api/index.php?act=common_goods&op=add_search_history",type:"post",dataType:"json",data:{token:FL.token,mid:FL.mid,flag:"wap",keywords:i,is_own:is_own},success:function(o){}})})}function n(o,s){"desc"==s?($(o).find("i").attr("class","icon-sort-down"),r=2,d=2,e("yes",2,2,1,i,c,is_own)):($(o).find("i").attr("class","icon-sort-up"),r=1,d=2,e("yes",1,2,1,i,c,is_own))}function t(){$(window).scroll(function(){var o=document.body.scrollHeight||document.documentElement.scrollHeight,s=document.body.clientHeight||document.documentElement.clientHeight,n=document.body.scrollTop||document.documentElement.scrollTop;if(n+s==o){var t=$(".media").length;f=t/10+1,u!=f&&l.test(f)?(e("no",r,d,f,i,c,is_own),u=f):layer.msg("已经没有商品了")}})}var i,c,a=10,r=2,d=3,l=/^[-]{0,1}[0-9]{1,}$/,u=0;if(i=GetQueryString("key"),c=GetQueryString("gc_id"),i){$("#goods_search").val(i);var f=1;e("yes",r,d,f,i,c)}if(is_own=GetQueryString("is_own"),is_own){var f=1;e("yes",r,d,f,i,c,1)}ImgFormat(),c=GetQueryString("gc_id"),e("yes",r,d,1,i,c,is_own),t(),s()}(this);